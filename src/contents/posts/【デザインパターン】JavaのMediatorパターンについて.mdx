---
title: ã€ãƒ‡ã‚¶ã‚¤ãƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³ã€‘Javaã®Mediatorãƒ‘ã‚¿ãƒ¼ãƒ³ã«ã¤ã„ã¦
slug: design-pattern/java-mediator-pattern
icon: â˜•ï¸
description: ä»Šå›ã¯mediatorãƒ‘ã‚¿ãƒ¼ãƒ³ã«ã¤ã„ã¦è§£èª¬ã—ã¾ã™ã€‚
date: "2023-09-27"
tags:
    - Java
    - ãƒ‡ã‚¶ã‚¤ãƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³
categories:
    - ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°
---

## Mediator

ã“ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã§ã¯è¤‡æ•°ã®å‡¦ç†ã®çŠ¶æ…‹ã‚’ç®¡ç†ã™ã‚‹å½¹ã‚’ã¤ãã‚Šã¾ã™ã€‚
ãƒãƒ¼ãƒ ã§ä»•äº‹ã‚’ã™ã‚‹æ™‚ã€æ¯å›ãƒ¡ãƒ³ãƒãƒ¼ã¨è©±ã—åˆã£ã¦ã„ã¦æ‰ã‚ã¦ã„ãŸã¨ã—ã¾ã™ã€‚
ä¾‹ãˆã°ã‚ãªãŸãŒã“ã®ä»•äº‹ãŒçµ‚ã‚ã£ãŸã‚‰æ¬¡ã®å®Ÿè£…ã«å…¥ã‚Œã‚‹ã‹ã‚‰æ•™ãˆã¦ã€ã¨Aã•ã‚“ã«ä¼ãˆã¾ã™ã€‚
Aã•ã‚“ã‚‚å®Ÿã¯åŒæ§˜ã«Bã•ã‚“ã®ä»•äº‹å¾…ã¡ã§ã—ãŸã€‚
ãã—ã¦Bã•ã‚“ã‹ã‚‰ã‚ãªãŸã¸ã¯åˆ¥ã®ä»•äº‹ã‚’ä»»ã•ã‚Œã¦ã„ã¦ã€å®Ÿã¯ãã‚ŒãŒçµ‚ã‚ã‚‰ãªã„ã¨Bã•ã‚“ãŒä»•äº‹ã‚’é€²ã‚ã‚‰ã‚Œãªã„ã®ã§ã™ã€‚

ã©ã“ã§ä½•ãŒèµ·ã“ã£ã¦ã„ã‚‹ã‹èª°ã‚‚æŠŠæ¡ã—ã¦ãªãã¦ã‚ã¡ã‚ƒãã¡ã‚ƒã«ãªã£ã¦ã—ã¾ã„ã¾ã™ã€‚
ã“ã‚Œã‚’é˜²ããŸã‚ã«ç›¸è«‡å½¹ã‚’ç«‹ã¦ã¾ã™ã€‚
å…¨å“¡ã¯ç›¸è«‡å½¹ã®äººã«çŠ¶æ³ã‚’çŸ¥ã‚‰ã›ã€å¤‰åŒ–ãŒã‚ã‚Œã°ç›¸è«‡å½¹ã¯å„å“¡ã«ãã‚Œã‚’çŸ¥ã‚‰ã›ã¾ã™ã€‚
ã“ã†ã™ã‚‹ã“ã¨ã§çŠ¶æ³ã®ç®¡ç†ã¨å®Ÿéš›ã®å‡¦ç†ã‚’åˆ†é›¢ã§ãã¾ã™ã€‚

ã“ã‚ŒãŒMediatorãƒ‘ã‚¿ãƒ¼ãƒ³ã§ã™ã€‚æ—©é€Ÿå®Ÿè·µã«å…¥ã‚Šã¾ã—ã‚‡ã†ã€‚

## å®Ÿè£…

ä»Šå›ã¯è»Šã®æ©Ÿèƒ½ã«ã¤ã„ã¦ã®å®Ÿè£…ã¨ã—ã¾ã™ã€‚
ã‚µã‚¤ãƒ‰ãƒ–ãƒ¬ãƒ¼ã‚­ã‚’ãƒªãƒªãƒ¼ã‚¹ã—ã¦ã€ã‚·ãƒ•ãƒˆã‚’ãƒ‰ãƒ©ã‚¤ãƒ–ã«å…¥ã‚Œã€ã‚¨ãƒ³ã‚¸ãƒ³ã‚’ã‹ã‘ã¦ã‚¢ã‚¯ã‚»ãƒ«ã‚’è¸ã¿ç™ºé€²ã—ã¾ã™ã€‚

### Mediator

ç›¸è«‡å½¹ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã§ã™ã€‚
å…·ä½“çš„ãªç›¸è«‡å½¹ã¯ã“ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’çµŒç”±ã—ã¦å®Ÿè£…ã—ã¾ã™ã€‚
ç›¸è«‡å½¹ãŒä¸€ç·’ã«åƒã„ã¦ã„ã‚‹åŒåƒšã‚’å®šç¾©ã—ã€å½¼ã‚‰ã«å¤‰åŒ–ã‚’çŸ¥ã‚‰ã›ã¾ã™ã€‚

```java:java
public interface Mediator {
    public abstract void createColleagues();
    public abstract void colleaguesChanged();
}
```

### Colleague

åŒåƒšã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã§ã™ã€‚
ç›¸è«‡å½¹ã‚’è¨­å®šã—ã€ç›¸è«‡å½¹ãŒå¤‰åŒ–ã‚’çŸ¥ã‚‰ã›ã¦ããŸéš›ã«ãã‚Œã«åŸºã¥ã„ã¦çŠ¶æ…‹ã‚’å¤‰ãˆã¾ã™ã€‚

```java:java
public interface Colleague {
    public abstract void setMediator(Mediator mediator);

    public abstract void setColleagueEnabled(boolean enabled);

    public abstract boolean isEnabled();
}
```

### ConcreteColleague

ã“ã“ã§ã¯å…·ä½“çš„ãªåŒåƒšã‚’è¨­å®šã—ã¾ã™ã€‚
ç°¡å˜ã®ãŸã‚ã€å…¨ã¦ã®å®Ÿè£…ã«ãŠã„ã¦èµ°ã‚Œã‚‹çŠ¶æ…‹ã‚’enabledã¨ã—ã¦ã„ã¾ã™ã€‚
å„ã‚¯ãƒ©ã‚¹ã®çŠ¶æ…‹ãŒenabled=trueã§ã‚ã‚Œã°èµ°ã‚Œã‚‹çŠ¶æ…‹ã«ã‚ã‚‹ã¨è€ƒãˆã¾ã™ã€‚

#### Engine

```java:java
public class Engine implements Colleague {
    private Mediator mediator;
    private boolean enabled;

    public Engine() {
        this.enabled = false;
    }

    public void setMediator(Mediator mediator) {
        this.mediator = mediator;
    }

    public void setColleagueEnabled(boolean enabled) {
        this.enabled = enabled;
    }

    public boolean isEnabled() {
        return enabled;
    }

    public void engineStarted() {
        this.enabled = true;
        mediator.colleaguesChanged();
    }
}
```

#### GearShift

```java:java
public class GearShift implements Colleague {
    private Mediator mediator;
    private boolean enabled;

    public GearShift() {
        this.enabled = false;
    }

    public void setMediator(Mediator mediator) {
        this.mediator = mediator;
    }

    public void setColleagueEnabled(boolean enabled) {
        this.enabled = enabled;
    }

    public boolean isEnabled() {
        return enabled;
    }

    public void gearShiftChangedToDrive() {
        this.enabled = true;
        mediator.colleaguesChanged();
    }
}
```

#### Accelerator

```java:java
public class Accelerator implements Colleague {
    private Mediator mediator;
    private boolean enabled;

    public Accelerator() {
        this.enabled = false;
    }

    public void setMediator(Mediator mediator) {
        this.mediator = mediator;
    }

    public void setColleagueEnabled(boolean enabled) {
        this.enabled = enabled;
    }

    public boolean isEnabled() {
        return enabled;
    }

    public void acceleratorPressed() {
        this.enabled = true;
        mediator.colleaguesChanged();
    }
}
```

#### HandBrake

```java:java
public class HandBrake implements Colleague {
    private Mediator mediator;
    private boolean enabled;

    public HandBrake() {
        this.enabled = false;
    }

    public void setMediator(Mediator mediator) {
        this.mediator = mediator;
    }

    public void setColleagueEnabled(boolean enabled) {
        this.enabled = enabled;
    }

    public boolean isEnabled() {
        return enabled;
    }

    public void handBrakeReleased() {
        this.enabled = true;
        mediator.colleaguesChanged();
    }
}
```

### CarDeparture

å…·ä½“çš„ãªç›¸è«‡å½¹ã§ã™ã€‚
å„ã‚¯ãƒ©ã‚¹ã®çŠ¶æ…‹ã‚’ç›£è¦–ã—ã€å¤‰åŒ–ãŒã‚ã‚Œã°ä»–ã®ã‚¯ãƒ©ã‚¹ã«æŒ‡ç¤ºã‚’å‡ºã—ã¾ã™ã€‚
ä¾‹ãˆã°ä»¥ä¸‹ã§ã¯ã‚¨ãƒ³ã‚¸ãƒ³ãŒã‹ã‹ã£ã¦ã„ãªã„çŠ¶æ…‹ã§ã‚·ãƒ•ãƒˆã‚’ãƒ‰ãƒ©ã‚¤ãƒ–ã«å…¥ã‚Œã‚ˆã†ã¨ã—ã¦ã‚‚ã‚¨ãƒ³ã‚¸ãƒ³ãŒã‹ã‹ã£ã¦ã„ãªã‘ã‚Œã°ã€æœ€åˆã«ã‚¨ãƒ³ã‚¸ãƒ³ã‚’ã‹ã‘ã‚‹ã‚ˆã†ã«ä¿ƒã—ã¦ã„ã¾ã™ã€‚ï¼ˆã“ã‚Œäº¤é€šãƒ«ãƒ¼ãƒ«ã¨ã—ã¦ã¯ãƒ€ãƒ¡ãªã‚“ã ã£ã‘ï¼‰

ã¾ã‚ä¾¿å®œä¸Šã§è¨­å®šã—ã¦ã„ã¦ã€ãƒ­ã‚¸ãƒƒã‚¯è‡ªä½“ã«æ·±ã„æ„å‘³ã¯ãªã„ã§ã™ã€‚
ã¨ã«ã‹ãã“ã®ç›¸è«‡å½¹ãŒåŒåƒšãŸã¡ã‹ã‚‰é€šçŸ¥ã‚’å—ã‘ã€ç¾åœ¨ã®å„åŒåƒšã®çŠ¶æ…‹ã‚’å…ƒã«ã©ã®ã‚ˆã†ãªæŒ‡ç¤ºã‚’å‡ºã™ã‹ã¨ã„ã†ãƒ­ã‚¸ãƒƒã‚¯ã‚’æŒã£ã¦ã„ã¾ã™ã€‚

```java:java
public class CarDeparture implements Mediator {
    private Accelerator accelerator;
    private GearShift gearShift;
    private HandBrake handBrake;
    private Engine engine;

    public CarDeparture(Accelerator accelerator, GearShift gearShift, HandBrake handBrake, Engine engine) {
        this.accelerator = accelerator;
        this.gearShift = gearShift;
        this.handBrake = handBrake;
        this.engine = engine;
        createColleagues();
    }

    public void createColleagues() {
        accelerator.setMediator(this);
        gearShift.setMediator(this);
        handBrake.setMediator(this);
        engine.setMediator(this);
    }

    public void colleaguesChanged() {
        if (!engine.isEnabled()) {
            System.out.println("You should start the engine first.");
            accelerator.setColleagueEnabled(false);
            gearShift.setColleagueEnabled(false);
            handBrake.setColleagueEnabled(false);
        } else if (!handBrake.isEnabled() || !gearShift.isEnabled() || !accelerator.isEnabled()) {
            System.out.println("You still have something to do.");
            accelerator.setColleagueEnabled(false);
        } else {
            System.out.println("You can depart now.");
        }
    }
    public void isReadyToDepart() {
        if (accelerator.isEnabled() && gearShift.isEnabled() && handBrake.isEnabled() && engine.isEnabled()) {
            System.out.println("Car is ready to depart.");
        } else if (!accelerator.isEnabled()) {
            System.out.println("Accelerator is not pressed.");
        } else if (!gearShift.isEnabled()) {
            System.out.println("Gear shift is not in drive.");
        } else if (!handBrake.isEnabled()) {
            System.out.println("Hand brake is not released.");
        } else if (!engine.isEnabled()) {
            System.out.println("Engine is not started.");
        }
    }
}
```

### Driver

é‹è»¢æ‰‹ã®ã‚¯ãƒ©ã‚¹ã§ã™ã€‚
ã“ã“ã§ã¯é‹è»¢ã«æˆåŠŸã™ã‚‹é †ç•ªã§å‡¦ç†ã‚’ã—ã¦ã„ããƒ‘ã‚¿ãƒ¼ãƒ³ã¨å¤±æ•—ã™ã‚‹ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’æ„å›³çš„ã«æ›¸ã„ã¦ã¾ã™ã€‚

```java:java
public class Driver {
    private Engine engine;
    private Accelerator accelerator;
    private HandBrake handBrake;
    private GearShift gearShift;
    private CarDeparture departure;
    public Driver() {
        engine = new Engine();
        accelerator = new Accelerator();
        handBrake = new HandBrake();
        gearShift = new GearShift();
        departure = new CarDeparture(accelerator, gearShift, handBrake, engine);
    }
    public void failToDepart() {
        System.out.println("Driver fail pattern.");
        accelerator.acceleratorPressed();
        engine.engineStarted();
        handBrake.handBrakeReleased();
        gearShift.gearShiftChangedToDrive();
        departure.isReadyToDepart();
    }
    public void succeedToDepart() {
        System.out.println("Driver success pattern.");
        engine.engineStarted();
        handBrake.handBrakeReleased();
        gearShift.gearShiftChangedToDrive();
        accelerator.acceleratorPressed();
        departure.isReadyToDepart();
    }
}
```

## å®Ÿè¡Œ

### Main

ãƒ‰ãƒ©ã‚¤ãƒãƒ¼ã«æˆåŠŸãƒ‘ã‚¿ãƒ¼ãƒ³ã¨å¤±æ•—ãƒ‘ã‚¿ãƒ¼ãƒ³ã§é‹è»¢ã—ã¦ã‚‚ã‚‰ã†ã ã‘ã§ã™ã€‚

```java:java
public class Main {
    public static void main(String[] args) {
        Driver driver = new Driver();
        driver.failToDepart();
        driver.succeedToDepart();
    }
}
```

å®Ÿè¡Œçµæœ

```
Driver fail pattern.
You should start the engine first.
You still have something to do.
You still have something to do.
You still have something to do.
Accelerator is not pressed.

Driver success pattern.
You still have something to do.
You still have something to do.
You still have something to do.
You can depart now.
Car is ready to depart.
```

ã¡ã‚‡ã£ã¨ãƒ­ã‚¸ãƒƒã‚¯è‡ªä½“ã¯é©å½“ã§ã™ãŒã€ä»Šå›å¤§åˆ‡ãªã®ã¯é‹è»¢ã‚’ã™ã‚‹å‡¦ç†ã¨ãã‚Œã‚‰ã®çŠ¶æ…‹ã‚’ç›£è¦–ã—ã¦å„ã‚¯ãƒ©ã‚¹ã«æŒ‡ç¤ºã‚’å‡ºã™éƒ¨åˆ†ã§åˆ†ã‘ã‚‹ã“ã¨ã§ã™ã€‚

ã“ã‚Œã«ã‚ˆã‚Šã€å„éƒ¨å“ã¯è‡ªåˆ†ãŸã¡ã®ã“ã¨ã—ã‹çŸ¥ã‚‰ãªãã¦å¤§ä¸ˆå¤«ã«ãªã‚Šã¾ã™ã€‚
ç›¸è«‡å½¹ã®CarDepartureã¯å†åˆ©ç”¨ã—ã¥ã‚‰ã„ã§ã™ãŒã€ä»–ã®éƒ¨å“ã¯ç°¡å˜ã«å†åˆ©ç”¨ã§ãã¾ã™ã€‚

å„çŠ¶æ…‹ã«åŸºã¥ã„ãŸãƒ­ã‚¸ãƒƒã‚¯ã‚‚ä»Šå›é©å½“ã§ã—ãŸã€ã‚‚ã—ä¿®æ­£ã™ã‚‹ã¨ãªã£ã¦ã‚‚CarDepartureã‚¯ãƒ©ã‚¹ã ã‘ä¿®æ­£ã™ã‚Œã°ã„ã„ã§ã™ã€‚ä¾‹ãˆã°ã‚·ãƒ•ãƒˆã‚’ãƒ‰ãƒ©ã‚¤ãƒ–ã«å…¥ã‚Œã¦ã‹ã‚‰ã§ãªã„ã¨ã‚µã‚¤ãƒ‰ãƒ–ãƒ¬ãƒ¼ã‚­ã‚’å¤–ã—ã¦ã¯ã„ã‘ãªã„ã¨ã‹ã€‚

See you later ğŸ‘‹