---
title: ã€ãƒ‡ã‚¶ã‚¤ãƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³ã€‘Javaã®Abstract Factoryãƒ‘ã‚¿ãƒ¼ãƒ³ã«ã¤ã„ã¦
slug: design-pattern/java-AbstractFactory-pattern
icon: â˜•ï¸
description: ä»Šå›ã¯AbstractFactoryãƒ‘ã‚¿ãƒ¼ãƒ³ã«ã¤ã„ã¦è§£èª¬ã—ã¾ã™ã€‚
date: "2023-09-19"
tags:
  - Java
  - ãƒ‡ã‚¶ã‚¤ãƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³
categories:
  - ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°
---

## AbstractFactory

ä»Šå›ã¯ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®è£…å‚™ã‚’ä½œã‚Šã¾ã™ã€‚

## å®Ÿè£…ï¼ˆframeworkï¼‰

frameworkãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã§ã¯

- **éƒ¨å“**ã¨ã—ã¦æŠ½è±¡çš„ãªè£…å‚™
- **è£½å“**ã¨ã—ã¦è£…å‚™ã—ãŸä¸€å¼
- 1ã¨2ã‚’ä½œã‚‹**å·¥å ´**
- è£…å‚™ã™ã‚‹**ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼**

ã‚’å®Ÿè£…ã—ã¾ã™ã€‚

### Equipment

Equipmentã‚¯ãƒ©ã‚¹ã§ã¯Templateãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ç”¨ã—ã¦è£…å‚™ã®ã‚¹ãƒ¼ãƒ‘ãƒ¼ã‚¯ãƒ©ã‚¹ã‚’å®Ÿè£…ã—ã¾ã™ã€‚
ã“ã“ã§ã¯è£…å‚™ãŒã‚ã‚Šã€è£…å‚™ã«å…±é€šã—ãŸå‡¦ç†ã ã‘ï¼ˆè£…å‚™ã™ã‚‹ã€è£…å‚™ã«å¿…è¦ãªèƒ½åŠ›ãŒã‚ã‚‹ã‹åˆ¤å®šã™ã‚‹ï¼‰ã‚’è¨˜è¼‰ã—ã¦ã„ã¾ã™ã€‚

```java:java
package framework;

public abstract class Equipment {
    protected String name;
    protected int requiredStatus;

    public Equipment(String name, int requiredStatus) {
        this.name = name;
        this.requiredStatus = requiredStatus;
    }
		// è£…å‚™ã«å¿…è¦ãªèƒ½åŠ›ã‚’æº€ãŸã—ã¦ã„ã‚Œã°è£…ç€ã™ã‚‹
    public void checkAndEquip(Player player, int requiredStatus) {
        if (isSatisfiedRequiredStatus(requiredStatus)) {
            Equip(player);
        } else {
            System.out.println("YOU CAN'T EQUIP THIS WEAPON");
            System.out.println("YOU NEED " + this.requiredStatus + " STATUS");
            System.out.println("YOUR STATUS IS " + this.requiredStatus);
        }
    }
		// è£…å‚™ã™ã‚‹ã€å…·ä½“çš„ãªå‡¦ç†ã¯è£…å‚™ã”ã¨ã«ç•°ãªã‚‹
    public abstract void Equip(Player player);
		
		// è£…å‚™ã«å¿…è¦ãªã‚³ã‚¹ãƒˆã‚’æº€ãŸã—ã¦ã„ã‚‹ã‹åˆ¤å®šã™ã‚‹
    public boolean isSatisfiedRequiredStatus(int playerStatus) {
        return playerStatus >= this.requiredStatus;
    }
}
```

### Weapon

Weaponã‚¯ãƒ©ã‚¹ã¯Equipmentã‚¯ãƒ©ã‚¹ã®ã‚µãƒ–ã‚¯ãƒ©ã‚¹ã§ã‚ã‚Šã€æŠ½è±¡ã‚¯ãƒ©ã‚¹ã§ã‚‚ã‚ã‚Šã¾ã™ã€‚
æœ€ã‚‚æŠ½è±¡çš„ãª`è£…å‚™`ã‹ã‚‰å°‘ã—æŠ½è±¡åº¦ã‚’è½ã¨ã—ãŸï¼ˆã‚ˆã‚Šå…·ä½“çš„ãªï¼‰`æ­¦å™¨`ã®ã‚¯ãƒ©ã‚¹ã‚’ä½œã‚‹ã‚¤ãƒ¡ãƒ¼ã‚¸ã§ã™ã€‚
ã“ã“ã§ã¯å…·ä½“çš„ãªè£…å‚™ï¼ˆEquipï¼‰ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å®šç¾©ã—ã¾ã™ã€‚
æ­¦å™¨ãªã®ã§è£…å‚™ã—ãŸã‚‰ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®æ”»æ’ƒåŠ›ã¨é˜²å¾¡åŠ›ã‚’ä¸Šæ˜‡ã•ã›ã¾ã™ã€‚

```java:java
package framework;

public abstract class Weapon extends Equipment {
    private final int attackStatus;
    private final int defenseStatus;
    public Weapon(String name, int attackStatus, int defenseStatus, int requiredStatus) {
        super(name, requiredStatus);
        this.attackStatus = attackStatus;
        this.defenseStatus = defenseStatus;
    }
    @Override
    public void Equip(Player player) {
        player.setEquipments(this);
        player.setStatus(this.attackStatus, this.defenseStatus);
        System.out.println("~~~~~~EQUIPPED~~~~~~");
        System.out.println("WEAPON NAME: " + this.name);
        System.out.println("ATTACK: " + this.attackStatus);
        System.out.println("DEFENSE: " + this.defenseStatus);
        System.out.println("~~~~~~~~~~~~~~~~~~~~");
    }
    @Override
    public String toString() {
        return "WEAPON NAME: " + this.name + "\nATTACK: " + this.attackStatus + "\nDEFENSE: " + this.defenseStatus;
    }
}
```

### Protector

Protectorã‚¯ãƒ©ã‚¹ã‚‚Weaponã‚¯ãƒ©ã‚¹åŒæ§˜ã«Equipmentã‚¯ãƒ©ã‚¹ã®ã‚µãƒ–ã‚¯ãƒ©ã‚¹ã§ã‚ã‚Šã€æŠ½è±¡ã‚¯ãƒ©ã‚¹ã§ã‚‚ã‚ã‚Šã¾ã™ã€‚
é˜²å…·ã‚’è£…å‚™ã—ãŸæ™‚ã®å…·ä½“çš„ãªå‡¦ç†ã‚’å®Ÿè£…ã—ã¾ã™ã€‚ï¼ˆé˜²å¾¡åŠ›ã®ä¸Šæ˜‡ï¼‰

```java:java
package framework;

public abstract class Protector extends Equipment {
    private final int defenseStatus;
    public Protector(String name, int requiredStatus, int defenseStatus) {
        super(name, requiredStatus);
        this.defenseStatus = defenseStatus;
    }
    @Override
    public void Equip(Player player) {
        player.setEquipments(this);
        player.setStatus(null,this.defenseStatus);
        System.out.println("~~~~~~EQUIPPED~~~~~~");
        System.out.println("ARMOR NAME: " + this.name);
        System.out.println("DEFENSE: " + this.defenseStatus);
        System.out.println("~~~~~~~~~~~~~~~~~~~~");
    }
    @Override
    public String toString() {
        return "ARMOR NAME: " + this.name + "\nDEFENSE: " + this.defenseStatus;
    }
}
```

### FullGear

FullGearã§ã¯è£…å‚™ä¸€å¼ã‚’è£…å‚™ã—ã¾ã™ã€‚æŠ½è±¡çš„ãªè£…å‚™ã‚’èº«ã«ã¤ã‘ã‚‹ã‚¤ãƒ¡ãƒ¼ã‚¸ã§ã™ã€‚
ãªã®ã§ã“ã“ã®è£…å‚™ä¸€å¼ã‚’ç€ç”¨ã—ãŸçŠ¶æ…‹ã‚‚æŠ½è±¡çš„ãªã‚‚ã®ã«ãªã‚Šã¾ã™ã€‚
Listã«è£…å‚™ã‚’è¿½åŠ ã—ã¦ã„ãã€è£…å‚™ãŒæƒã£ãŸã‚‰SetUpEquipmentsã§ç€ç”¨ã—ã¾ã™ã€‚

```java:java
package framework;

import java.util.*;

public abstract class FullGear {
    protected List<Equipment> equipments = new ArrayList<>();
    public void add(List<Equipment> _equipments) {
        equipments.addAll(_equipments);
    }
    public abstract void SetUpEquipments(Player player);
}
```

### Factory

ä¸Šè¨˜ã®è£…å‚™ã‚’ä½œã‚‹æŠ½è±¡çš„ãªå·¥å ´ã§ã™ã€‚
ä»Šå¾Œã€è£…å‚™ã¯æˆ¦å£«è·ã‚„é­”æ³•è·ãªã©è‰²ã€…ãªã‚¸ãƒ§ãƒ–ã«åˆã‚ã›ã¦è£½é€ ã—ã¦ã„ãäºˆå®šãªã®ã§ãã‚Œã‚‰ã®ã‚¸ãƒ§ãƒ–ã«å¿œã˜ãŸè£…å‚™ä¸€å¼ãŒä½œã‚Œã‚‹ã‚ˆã†ã«ã‚¯ãƒ©ã‚¹åã«ä¾å­˜ã—ãªã„ã‚ˆã†ã«ã—ã¾ã™ã€‚
ãã®ãŸã‚ã€getFactoryã§ã¯ã‚¯ãƒ©ã‚¹åã‚’å¼•æ•°ã¨ã—ã¦ãã‚Œã«å¿œã˜ãŸã‚¯ãƒ©ã‚¹ã‚’è¿”ã™ã‚ˆã†ã«ã—ã¦ã„ã¾ã™ã€‚
ã©ã®å·¥å ´ã§ã‚‚å…±é€šã—ã¦æ­¦å™¨ã¨é˜²å…·ã¯ä½œã‚‹ã“ã¨ã¨ã—ãŸã„ã®ã§ãã‚Œç”¨ã®æŠ½è±¡ãƒ¡ã‚½ãƒƒãƒ‰ã‚‚å®šç¾©ã—ã¦ãŠãã¾ã™ã€‚

```java:java
package framework;

public abstract class Factory {
    public static Factory getFactory(String classname) {
        Factory factory = null;
        try {
            factory = (Factory) Class.forName(classname).getDeclaredConstructor().newInstance();
        } catch (ClassNotFoundException e) {
            System.out.println("Class " + classname + " not found.");
        } catch (Exception e) {
            e.printStackTrace();
        }
        return factory;
    }

    public abstract Weapon createWeapon(String classname, String name, int attackStatus, int defenseStatus, int requiredStatus);
    public abstract Protector createProtector(String classname, String name, int requiredStatus, int defenseStatus);
    public abstract FullGear createFullGear();
}
```

### Player

è£…å‚™ã‚’ç€ç”¨ã™ã‚‹ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã§ã™ã€‚
ã‚¸ãƒ§ãƒ–ã”ã¨ã«åˆ†ã‘ã‚‹å ´åˆã€æŠ½è±¡çš„ãªã‚¯ãƒ©ã‚¹ã¨ã—ã¦å®šç¾©ã—ã¦ã‚µãƒ–ã‚¯ãƒ©ã‚¹ã§å®Ÿè£…ã—ã¦ã‚‚è‰¯ã„ã§ã™ãŒç°¡å˜ã®ãŸã‚ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã¯å…±é€šã®ã‚‚ã®ã¨ã—ã¾ã™ã€‚
ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ãŒæ­¦å™¨ã‚’è£…å‚™ã™ã‚‹ãŸã‚ã€Equipmentã‚¯ãƒ©ã‚¹ã®Equipãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ç”¨ã—ã¦è£…å‚™ã‚’ç€ç”¨ã€ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã«åæ˜ ã•ã›ã‚‹å‡¦ç†ã‚’å®Ÿè£…ã—ã¦ã„ã¾ã™ã€‚

```java:java
package framework;

import java.util.ArrayList;
import java.util.List;

public class Player {
    private final String name;
    private final List<Equipment> equipments = new ArrayList<Equipment>();

		private int attackStatus;
    private int defenseStatus;
    private final int strengthStatus;
    private final int weightStatus;

    public Player(String name, int attackStatus, int defenseStatus, int strengthStatus, int weightStatus) {
        this.name = name;
        this.attackStatus = attackStatus;
        this.defenseStatus = defenseStatus;
        this.strengthStatus = strengthStatus;
        this.weightStatus = weightStatus;
    }

    public void setStatus(Integer attackStatus, Integer defenseStatus) {
        if (attackStatus != null) {
            this.attackStatus += attackStatus;
        }
        if (defenseStatus != null) {
            this.defenseStatus += defenseStatus;
        }
    }
    public void setEquipments(Equipment equipment) {
        this.equipments.add(equipment);
    }
    public void showEquipments() {
        if(this.equipments.isEmpty()) {
            System.out.println("NO EQUIPMENTS");
            return;
        }
        System.out.println("-------EQUIPMENTS-------");
        for (Equipment equipment : this.equipments) {
            System.out.println(equipment.toString());
        }
        System.out.println("------------------------");
    }

    public int getAttackStatus() { return this.attackStatus; }

    public int getDefenseStatus() { return this.defenseStatus; }

    public int getStrengthStatus() { return this.strengthStatus; }

    public int getWeightStatus() { return this.weightStatus; }

    public void showStatus() {
        System.out.println("====PLAYER STATUS====");
        System.out.println("Player: " + name);
        showEquipments();
        System.out.println("Attack: " + attackStatus);
        System.out.println("Defense: " + defenseStatus);
        System.out.println("=====================");
    }
}
```

æŠ½è±¡çš„ãªéƒ¨åˆ†ã®å®Ÿè£…ãŒçµ‚ã‚ã£ãŸãŸã‚ã„ã‚ˆã„ã‚ˆå…·ä½“çš„ãªå®Ÿè£…ã«å…¥ã£ã¦ã„ãã¾ã™ã€‚

## å®Ÿè£…ï¼ˆwarriorfactoryï¼‰

warriorfactoryãƒ‘ãƒƒã‚±ãƒ¼ã‚¸å†…ã§ã¯æˆ¦å£«è·å‘ã‘ã®å…·ä½“çš„ãªæ­¦å™¨ãƒ»é˜²å…·ã€è£…å‚™ä¸€å¼ã¨ãã‚Œã‚‰ã‚’è£½é€ ã™ã‚‹å·¥å ´ã‚’ä½œã£ã¦ã„ãã¾ã™ã€‚

### Sword

Weaponã‚¯ãƒ©ã‚¹ã®ã‚µãƒ–ã‚¯ãƒ©ã‚¹ã§ã™ã€‚
å‰£ã¯æ”»æ’ƒãŒã§ãã‚‹ã€ã¨ã„ã†ã“ã¨ã‚’ç¤ºã™ãŸã‚ã«Attackãƒ¡ã‚½ãƒƒãƒ‰ã‚’è¿½åŠ ã—ã¦ã„ã¾ã™ã€‚
ï¼ˆä»–ã®æ­¦å™¨ã‚¯ãƒ©ã‚¹ã¨å·®åˆ¥ã™ã‚‹ãŸã‚ã«åŠ ãˆã¦ã„ã‚‹ã ã‘ãªã®ã§ä»Šå›ã¯ä½¿ç”¨ã—ã¾ã›ã‚“ã€‚ï¼‰

```java:java
package warriorfactory;

import framework.Weapon;

public class Sword extends Weapon {
    public Sword(String name, int attackStatus, int defenseStatus, int requiredStatus) {
        super(name, attackStatus, defenseStatus, requiredStatus);
    }
    public void Attack() {
        System.out.println("ATTACKED WITH " + this.name);
    }
}
```

### Shield

Weaponã‚¯ãƒ©ã‚¹ã®ã‚µãƒ–ã‚¯ãƒ©ã‚¹ã§ã™ã€‚
ã“ã¡ã‚‰ã§ã¯ç›¾ç‰¹æœ‰ã®ãƒ¡ã‚½ãƒƒãƒ‰ã¨ã—ã¦Defendãƒ¡ã‚½ãƒƒãƒ‰ã‚’ã¤ã‘ã¦ã„ã¾ã™ã€‚
ï¼ˆSwordã‚¯ãƒ©ã‚¹åŒæ§˜ä»Šå›ã®ã‚³ãƒ¼ãƒ‰ã®ä¸­ã§ã¯ä½¿ã£ã¦ã¾ã›ã‚“ã€‚ï¼‰

```java:java
package warriorfactory;

import abstruct_framework.Weapon;

public class Shield extends Weapon {
    public Shield(String name, int attackStatus, int defenseStatus, int requiredStatus) {
        super(name, attackStatus, defenseStatus, requiredStatus);
    }
    public void Defend() {
        System.out.println("DEFENDED WITH " + this.name);
    }
}
```

### WarriorFullGear

FullGearã‚¯ãƒ©ã‚¹ã®ã‚µãƒ–ã‚¯ãƒ©ã‚¹ã«ãªã‚Šã¾ã™ã€‚
è£…å‚™ãŒæˆ¦å£«ãŒç€ç”¨å¯èƒ½ãªSword, Shield, Armorã§ã‚ã‚Œã°ã‚¹ãƒ¼ãƒ‘ãƒ¼ã‚¯ãƒ©ã‚¹ã®checkAndEquipãƒ¡ã‚½ãƒƒãƒ‰ã‚’ç”¨ã„ã¦ç€ç”¨ã—ã¾ã™ã€‚

```java:java
package warriorfactory;

import framework.Equipment;
import framework.Protector;
import framework.FullGear;
import framework.Player

public class WarriorFullGear extends FullGear {
    @Override
    public void SetUpEquipments(Player player) {
        for (Equipment equipment : equipments) {
            if ((equipment instanceof Sword) || (equipment instanceof Shield)) {
                equipment.checkAndEquip(player, player.getStrengthStatus());
            } else if (equipment instanceof Armor) {
                equipment.checkAndEquip(player, player.getWeightStatus());
            } else {
                System.out.println("ERROR: UNKNOWN EQUIPMENT TYPE");
            }
        }
    }
}
```

## å®Ÿè£…ï¼ˆMainã‚¯ãƒ©ã‚¹ï¼‰

ã‚³ãƒ¼ãƒ‰ã‚’è¦‹ã¦ã„ãŸã ã‘ã‚Œã°åˆ†ã‹ã‚‹é€šã‚Šã€Mainã‚¯ãƒ©ã‚¹ã¯frameworkãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã«ã—ã‹ä¾å­˜ã—ã¦ã„ã¾ã›ã‚“ã€‚
å…·ä½“çš„ãªå‡¦ç†ã¯Mainã‹ã‚‰éš è”½ã§ãã¾ã—ãŸã€‚
ä»Šå›ã¯æˆ¦å£«è·ã®è£…å‚™ã‚’ä½œã‚‹ã“ã¨ãŒç›®çš„ãªã®ã§ã€warriorfactoryã®ã‚¯ãƒ©ã‚¹åã•ãˆåˆ†ã‹ã‚Œã°ãã‚Œã‚’frameworkã§å®šç¾©ã—ãŸæŠ½è±¡çš„ãªå·¥å ´ã«æ¸¡ã™ã“ã¨ã§ç°¡å˜ã«è£…å‚™ä¸€å¼ã‚’ä½œã£ã¦è£…ç€ã—ã€ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã®åæ˜ ã¾ã§è¡Œã£ã¦ãã‚Œã¾ã™ã€‚

```java:java
package warriorfactory;

import framework.Equipment;
import framework.Factory;
import framework.FullGear;

import java.util.ArrayList;
import java.util.List;

public class Main {
    public static void main(String[] args) {
        Player player = new Player("KURIMATSU", 100, 100, 100, 100);
        player.showStatus();
        Factory factory = Factory.getFactory("warriorfactory.WarriorFactory");
        List<Equipment> equipments = new ArrayList<>();
        equipments.add(factory.createWeapon("warriorfactory.Sword", "SWORD-X", 10, 0, 0));
        equipments.add(factory.createWeapon("warriorfactory.Shield", "SHIELD-X", 0, 10, 0));
        equipments.add(factory.createProtector("warriorfactory.Armor", "ARMOR-X", 10, 50));
        FullGear fullGear = factory.createFullGear();
        fullGear.add(equipments);
        fullGear.SetUpEquipments(player);
        player.showStatus();
    }
}
```

### å®Ÿè¡Œçµæœ

```
====PLAYER STATUS====
Player: KURIMATSU
NO EQUIPMENTS
Attack: 100
Defense: 100
=====================
~~~~~~EQUIPPED~~~~~~
WEAPON NAME: SWORD-X
ATTACK: 10
DEFENSE: 0
~~~~~~~~~~~~~~~~~~~~
~~~~~~EQUIPPED~~~~~~
WEAPON NAME: SHIELD-X
ATTACK: 0
DEFENSE: 10
~~~~~~~~~~~~~~~~~~~~
~~~~~~EQUIPPED~~~~~~
ARMOR NAME: ARMOR-X
DEFENSE: 50
~~~~~~~~~~~~~~~~~~~~
====PLAYER STATUS====
Player: KURIMATSU
-------EQUIPMENTS-------
WEAPON NAME: SWORD-X
ATTACK: 10
DEFENSE: 0
WEAPON NAME: SHIELD-X
ATTACK: 0
DEFENSE: 10
ARMOR NAME: ARMOR-X
DEFENSE: 50
------------------------
Attack: 110
Defense: 160
=====================
```

ä»Šå›ã¯æˆ¦å£«è·ã—ã‹ä½œã‚Šã¾ã›ã‚“ã§ã—ãŸãŒã€frameworkãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ä½¿ãˆã°ç°¡å˜ã«é­”æ³•è·ç”¨ã®è£…å‚™ã‚‚è¿½åŠ ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ï¼ˆæ–ã‚„ã‚³ãƒ¼ãƒ‰ãªã©ï¼‰

See you later ğŸ‘‹