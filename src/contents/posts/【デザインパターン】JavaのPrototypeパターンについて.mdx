---
title: ã€ãƒ‡ã‚¶ã‚¤ãƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³ã€‘Javaã®Prototypeãƒ‘ã‚¿ãƒ¼ãƒ³ã«ã¤ã„ã¦
slug: design-pattern/java-prototype-pattern
icon: â˜•ï¸
description: ä»Šå›ã¯Prototypeãƒ‘ã‚¿ãƒ¼ãƒ³ã«ã¤ã„ã¦è§£èª¬ã—ã¾ã™ã€‚
date: "2023-09-17"
tags:
  - Java
  - ãƒ‡ã‚¶ã‚¤ãƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³
categories:
  - ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°
---
## Prototype

æ—¢å­˜ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ç”¨ã„ã¦ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’ä½œã‚Šã€ãã‚Œã‚’å…ƒã«åˆ¥ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ã‚³ãƒ”ãƒ¼ã—ã¦ä½œæˆã—ã¾ã™ã€‚
Prototypeãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’é©ç”¨ã™ã‚‹ã“ã¨ã§é››å½¢ã®ä½œæˆã€ä¿å­˜ã€ã‚³ãƒ”ãƒ¼ã®ãƒ­ã‚¸ãƒƒã‚¯ã‚’åˆ†ã‘ã¦æ•´ç†ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

## å®Ÿè£…

ä»Šå›ã¯RPGé¢¨ã«ã€æ•µãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã®ã‚¯ãƒ©ã‚¹ã‚’ä½œã£ã¦å¢—æ®–ã•ã›ã¾ã™ã€‚

### Enemyã‚¯ãƒ©ã‚¹

æ•µã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚’è¨˜è¿°ã—ãŸã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã§ã™ã€‚
Cloneableã¨ã™ã‚‹ã“ã¨ã§å®Ÿè£…å…ˆã§cloneãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ç”¨ã—ã¦ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’è¤‡è£½ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

```java:java
public interface Enemy extends Cloneable {
    public void battle_turn();
    public Enemy createCopy();
}
```

### Managerã‚¯ãƒ©ã‚¹

Enemyã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’åˆ©ç”¨ã—ã¦ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®è¤‡è£½ã‚’è¡Œã„ã¾ã™ã€‚
showcaseã«KeyValueã®é…åˆ—ã§ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’æ ¼ç´ã—ã¦ã€getãƒ¡ã‚½ãƒƒãƒ‰ã‚’ç”¨ã„ã¦åå‰ã ã‘ã§å‘¼ã³å‡ºã›ã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚
ã“ã‚Œã«ã‚ˆã‚Šã‚¯ãƒ©ã‚¹åã‹ã‚‰è§£æ”¾ã•ã‚Œä»»æ„ã®è¨­å®šã—ãŸåå‰ã‹ã‚‰ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å‘¼ã³å‡ºã›ã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

```java:java
import java.util.HashMap;
import java.util.Map;

public class Manager {
    public Map<String, Enemy> showcase = new HashMap<String, Enemy>();
    public void register(String name, Enemy enemy) {
        showcase.put(name, enemy);
    }
    public Enemy create(String name) {
        Enemy enemy = showcase.get(name);
        return enemy.createCopy();
    }
}
```

### Monsterã‚¯ãƒ©ã‚¹

Enemyã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’å®Ÿè£…ã—ãŸãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã§ã™ã€‚
createCopyã§ã‚¯ãƒ­ãƒ¼ãƒ³ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ç”¨ã„ã¦è‡ªèº«ã®ã‚¯ãƒ­ãƒ¼ãƒ³ã‚’ä½œæˆã—è¿”ã—ã¾ã™ã€‚
ã“ã®æ™‚ã€ç¾åœ¨ã®åå‰ã‚„hpã®æƒ…å ±ã¯å¼•ãç¶™ãŒã‚Œã¾ã™ã€‚

```java:java
public class Monster implements Enemy {
    private final String name;
    private int hp;
    private boolean isClone = false;
    public Monster(String name, int hp) {
        this.name = name;
        this.hp = hp;
    }
    @Override
    public void battle_turn() {
        String MonsterTypeLabel = isClone ? "Monster(Clone): " : "Monster: ";
        System.out.println("----start battle----");
        System.out.println(MonsterTypeLabel + name + " HP: " + hp);
        hp -= 10;
        System.out.println("get damage");
        System.out.println(MonsterTypeLabel + name + " HP: " + hp);
        System.out.println("-----end battle-----");
    }
    @Override
    public Enemy createCopy() {
        Enemy enemy = null;
        try {
            enemy = (Enemy)clone();
        } catch (CloneNotSupportedException e) {
            e.printStackTrace();
        }
        System.out.println("===Monster created===");
        System.out.println("Monster(Clone): " + name + " HP: " + hp);
				return enemy;
    }
}
```

ã¡ãªã¿ã«ã€ä¸Šè¨˜ã§ã¯ã‚¯ãƒ­ãƒ¼ãƒ³ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ç”¨ã„ã¦ã„ã¾ã™ãŒã‚¯ãƒ­ãƒ¼ãƒ³ã™ã‚‹å…ˆã®å‹ãŒæ±ºã¾ã£ã¦ã„ã‚Œã°ä¸‹è¨˜ã§ã‚‚å‹•ä½œã—ã¾ã™ã€‚

```java:java
public class Monster implements Enemy {
		...
    public Monster(String name, int hp) {
			...
    }
		// ã‚³ãƒ”ãƒ¼ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿
    public Monster(Monster monster) {
        this.name = monster.name;
        this.hp = monster.hp;
        this.isClone = true;
    }
    @Override
    public void battle_turn() {
			...
    }
    @Override
    public Enemy createCopy() {
        System.out.println("===Monster created===");
        System.out.println("Monster(Clone): " + name + " HP: " + hp);
        return new Monster(this);
    }
}
```

ã“ã¡ã‚‰ã§ã¯**ã‚³ãƒ”ãƒ¼ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿**ã‚’ç”¨ã„ã¦ã‚¯ãƒ­ãƒ¼ãƒ³ã‚’ä½œæˆã—ã¦ã¾ã™ã€‚
ä¸Šè¨˜ã®ã‚³ãƒ¼ãƒ‰ã®æ–¹ãŒä¾‹å¤–å‡¦ç†ã‚‚ãªãã‚¹ãƒ ãƒ¼ã‚ºã§è‰¯ã„ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚
ã‚¯ãƒ­ãƒ¼ãƒ³ã¯ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚„ã‚¹ãƒ¼ãƒ‘ãƒ¼ã‚¯ãƒ©ã‚¹ã®cloneãƒ¡ã‚½ãƒƒãƒ‰ã‚’ã‚ªãƒ¼ãƒãƒ¼ãƒ©ã‚¤ãƒ‰ã™ã‚‹ã“ã¨ã§ã€å…·ä½“çš„ãªã‚µãƒ–ã‚¯ãƒ©ã‚¹ã®å‹ã‚’çŸ¥ã‚‰ãªãã¦ã‚‚ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’è¤‡è£½ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
ã“ã‚Œã¯å…·ä½“çš„ãªã‚µãƒ–ã‚¯ãƒ©ã‚¹ã®å‹ãŒãƒ©ãƒ³ã‚¿ã‚¤ãƒ ã§ã®ã¿ã‚ã‹ã‚‹ã‚ˆã†ãªå ´é¢ã§å½¹ç«‹ã¡ã¾ã™ã€‚

### Mainã‚¯ãƒ©ã‚¹

ã“ã“ã§ã¯

1. ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã‚’ä½œã‚‹
2. ä½œã£ãŸãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã‚’ç™»éŒ²ã™ã‚‹
3. ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã‚’ã‚³ãƒ”ãƒ¼ã™ã‚‹

ã¨ã„ã†ãƒ•ã‚§ãƒ¼ã‚ºã”ã¨ã«ãƒ­ã‚¸ãƒƒã‚¯ã‚’åˆ†é›¢ã—ã¦ã„ã¾ã™ã€‚
ã“ã‚Œã«ã‚ˆã‚Šã€ãã‚Œãã‚Œã®ãƒ¡ã‚½ãƒƒãƒ‰ã§ã‚¹ã‚±ãƒ¼ãƒ«ã‚„æ”¹å¤‰ãŒã—ã‚„ã™ããªã‚Šã¾ã™ã€‚

```java
public class Main {
    public static void main(String[] args) {
				// 1. ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã‚’ä½œã‚‹
        Manager manager = new Manager();
        Enemy slime = new Monster("slime", 100);
        Enemy dragon = new Monster("dragon", 1000);
				// 2. ä½œã£ãŸãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã‚’ç™»éŒ²ã™ã‚‹
        manager.register("slime", slime);
        manager.register("dragon", dragon);
        slime.battle_turn();
        dragon.battle_turn();
				// 3. ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã‚’ã‚³ãƒ”ãƒ¼ã™ã‚‹
        Enemy slime1 = manager.create("slime");
        slime1.battle_turn();
        slime.battle_turn();
    }
}
```

ã¾ãŸå®Ÿè¡Œçµæœã‹ã‚‰åˆ†ã‹ã‚‹é€šã‚Šã€çŠ¶æ…‹ã‚‚ã‚³ãƒ”ãƒ¼ã•ã‚Œã¦ã„ã¾ã™ã€‚

å®Ÿè¡Œçµæœ

```
----start battle----
Monster: slime HP: 100
get damage
Monster: slime HP: 90
-----end battle-----
----start battle----
Monster: dragon HP: 1000
get damage
Monster: dragon HP: 990
-----end battle-----
===Monster created===
Monster(Clone): slime HP: 90
----start battle----
Monster(Clone): slime HP: 90
get damage
Monster(Clone): slime HP: 80
-----end battle-----
===Monster created===
Monster(Clone): slime HP: 90
----start battle----
Monster(Clone): slime HP: 90
get damage
Monster(Clone): slime HP: 80
-----end battle-----
----start battle----
Monster: slime HP: 90
get damage
Monster: slime HP: 80
-----end battle-----
```

See you later ğŸ‘‹