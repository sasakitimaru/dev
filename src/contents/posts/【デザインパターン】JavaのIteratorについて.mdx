---
title: ã€ãƒ‡ã‚¶ã‚¤ãƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³ã€‘Javaã®Iteratorã«ã¤ã„ã¦
icon: â˜•ï¸
description: ä»Šæ—¥ã‹ã‚‰è‡ªåˆ†ã®å¿˜å‚™éŒ²ã‚‚å…¼ã­ã¦ãƒ‡ã‚¶ã‚¤ãƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚·ãƒªãƒ¼ã‚ºã‚’ã¾ã¨ã‚ã¦è¡Œã“ã†ã¨æ€ã„ã¾ã™ã€‚
date: "2023-09-14"
categories:
  - Java
  - ãƒ‡ã‚¶ã‚¤ãƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³
---
## Iteratorã¨ã¯

Iterator=ç¹°ã‚Šè¿”ã—ã€€ã§ã™ã€‚
java.lang.Iterable, java.utils.Iteratorã‹ã‚‰importã™ã‚‹ã“ã¨ã§ä½¿ç”¨ã§ãã¾ã™ã€‚

>```java:java
>public interface Iterable<E>{
>   public abstruct Iterator<E> iterator();
>}
>```

>```java:java
>public interface Iterator<E>{
>	public abstract boolean hasNext();
>	public abstract E next();
>}
>```

ä¸Šè¨˜ã®æŠ½è±¡interfaceã‚’implementsã—ã¦ä½¿ã„ã¾ã™ã€‚
```java
public MenuList implements Iterable<Menu> {}
```

## ãªã‚“ã§ä½¿ã†ã®ï¼Ÿ

ãƒ«ãƒ¼ãƒ—ã®å‡¦ç†ã‚’æŠ½è±¡åŒ–ã—ã¦å®Ÿè£…ã¨åˆ‡ã‚Šåˆ†ã‘ã‚‹ã“ã¨ã§ä¿å®ˆæ€§ã‚’é«˜ã‚ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
ä¾‹ãˆã°Javaã®Foræ–‡ã§ã¯è£ã§ã“ã®Iteratorã‚’å‘¼ã³å‡ºã—ã¦é…åˆ—ã‚’ä¸€ã¤ãšã¤å›ã—ã¦ãƒã‚§ãƒƒã‚¯ã‚’ã—ã¦ã„ã¾ã™ã€‚Iteratorã‚’å®Ÿè¡Œã™ã‚‹MenuListã‚’ä½œã‚Œã°ä¸‹è¨˜ã®ã‚ˆã†ãªå®Ÿè£…ãŒã§ãã¾ã™ã€‚

```java
for(Menu menu: MenuList){
	System.out.println(menu.getName());
}
```

ä½¿ã£ã¦ã¿ãªãã‚ƒåˆ†ã‹ã‚‰ã‚“ã¨æ€ã†ã®ã§å®Ÿè£…ã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚

## å®Ÿè£…

ä»Šå›ã¯æœç‰©ã®ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã®ãƒªã‚¹ãƒˆã‚’ä½œã£ã¦ã¿ã¾ã™ã€‚

### Menuã‚¯ãƒ©ã‚¹

```java:java
public class Menu {
    public String name;
    public String price;
    public Menu(String name, String price) {
        this.name = name;
        this.price = price;
    }

    public String getName() {
        return name;
    }

    public String getPrice() {
        return price;
    }
}
```

### MenuListã‚¯ãƒ©ã‚¹

Iterableã‚’å®Ÿè£…ã™ã‚‹ã“ã¨ã§iteratorã®å…·ä½“çš„ãªå‡¦ç†ã‚’ã‚ªãƒ¼ãƒãƒ¼ãƒ©ã‚¤ãƒ‰ï¼ˆå®Ÿè£…ï¼‰ã—ã¾ã™ã€‚
å…·ä½“çš„ã¨ã„ã£ã¦ã‚‚ã“ã“ã§ã¯MenuListIteratorã¨ã„ã†ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’è¿”ã™ã ã‘ã§ã€ã“ã¡ã‚‰ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã«å®Ÿéš›ã®å‡¦ç†ã¯å¾Œã»ã©æ›¸ãã¾ã™ã€‚ãã‚Œã‚’ç”¨ã„ã‚‹ã‚ˆã€ã¨ã„ã†ã“ã¨ã§ã™ã€‚
foræ–‡ã¯ã“ã®iteratorã‚’ç”¨ã„ã¦é †ç¹°ã‚Šã«å€¤ã‚’å‚ç…§ã™ã‚‹ã“ã¨ã«ãªã‚Šã¾ã™ã€‚

```java:java
import java.util.Iterator;

public class MenuList implements Iterable<Menu>{
    private Menu[] menus;
    public int last = 0;
    public MenuList(int max_size) {
        this.menus = new Menu[max_size];
    }
    public void addMenu(Menu menu){
        this.menus[last] = menu;
        last++;
    }
    public Menu getMenuAt(int index){
        return menus[index];
    }
    @Override
    public Iterator<Menu> iterator() {
        return new MenuListIterator(this);
    }
}
```

### MenuListIteratorã‚¯ãƒ©ã‚¹

ã“ã“ã§é…åˆ—ã®ã‚¹ã‚­ãƒ£ãƒ³ã‚’è¡Œã†ãŸã‚ã®å…·ä½“çš„ãªãƒ¡ã‚½ãƒƒãƒ‰ã®ä¸­èº«ã‚’å®Ÿè£…ã—ã¾ã™ã€‚
hasNext()ã¯é…åˆ—ã®æ¬¡ã®å€¤ãŒå­˜åœ¨ã™ã‚‹ã‹ã©ã†ã‹ã‚’ç¢ºèªã€next()ã¯ç¾åœ¨å‚ç…§ã•ã‚Œã¦ã„ã‚‹Menuã‚’è¿”ã—ã¦ã‹ã‚‰æ¬¡ã¸é…åˆ—ã‚’é€²ã‚ã‚‹å‡¦ç†ã‚’ã—ã¦ã„ã¾ã™ã€‚

```java:java
import java.util.Iterator;
public class MenuListIterator implements Iterator<Menu>{
    private MenuList menuList;
    public int index = 0;
    public MenuListIterator(MenuList menuList) {
        this.menuList = menuList;
    }
    @Override
    public boolean hasNext() {
        return index < menuList.last;
    }
    @Override
    public Menu next() {
        if(!hasNext()){
            throw new IndexOutOfBoundsException();
        } else {
            Menu menu = menuList.getMenuAt(index);
            index++;
            return menu;
        }
    }
}
```

### Mainã‚¯ãƒ©ã‚¹

ãƒ¡ã‚¤ãƒ³ã‚¯ãƒ©ã‚¹ã§ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’è¿½åŠ ã—ã€ãƒ«ãƒ¼ãƒ—å‡¦ç†ã‚’å®Ÿéš›ã«è¡Œã„ã¾ã™ã€‚

```java:java
import java.util.Iterator;

public class Main {
    public static void main(String[] args) {
        MenuList menuList = new MenuList(5);
        menuList.addMenu(new Menu("lemon", "200"));
        menuList.addMenu(new Menu("strawberry", "300"));
        menuList.addMenu(new Menu("orange", "400"));
        menuList.addMenu(new Menu("apple", "500"));
        menuList.addMenu(new Menu("banana", "600"));
        Iterator<Menu> it = menuList.iterator();
        while (it.hasNext()) {
            Menu menu = it.next();
            System.out.println("name:" + menu.getName() + " price:" + menu.getPrice());
        }
    }
}
```

ã“ã†ã™ã‚‹ã“ã¨ã§ã€menuListã‚’é…åˆ—ã¨ã—ã¦æ‰±ã†ã“ã¨ãŒã§ãã¾ã™ã€‚
ã¡ãªã¿ã«ã“ã‚Œã¯ä»¥ä¸‹ã§ã‚‚å‡ºåŠ›ã§ãã¾ã™ã€‚

```java
Menu[] menus = menuList.menus;
for(Menu menu: menus) {
	...
}
```

ã˜ã‚ƒã‚ã“ã‚Œã§è‰¯ãã­ã€‚ã¦ãªã‚Šã¾ã™ãŒæŠ½è±¡åŒ–ã¯è‰²ã€…ã„ã„ã“ã¨ã‚‚ã‚ã‚Šã¾ã™ã€‚

1. **æ±ç”¨æ€§**: **`Iterator`** ã¯ã€**`Collection`** ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã®ã™ã¹ã¦ã®å®Ÿè£…ã«å¯¾ã—ã¦å‹•ä½œã—ã¾ã™ã€‚ã¤ã¾ã‚Šã€List, Set, Queueãªã©ã®æ§˜ã€…ãªãƒ‡ãƒ¼ã‚¿æ§‹é€ ã«å¯¾ã—ã¦çµ±ä¸€çš„ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹æ‰‹æ®µã‚’æä¾›ã—ã¾ã™ã€‚
2. **ä¿®æ­£ã®å®‰å…¨æ€§**: **`Iterator`** ã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã‚’åå¾©å‡¦ç†ã—ã¦ã„ã‚‹æœ€ä¸­ã«ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã‚’å®‰å…¨ã«å¤‰æ›´ã™ã‚‹ã“ã¨ãŒã§ãã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚
    
    ```java
    while (it.hasNext()) {
        Menu menu = it.next();
        if (menu.getName().equals("banana")) {
            it.remove();
        }
    }
    
    System.out.println(list);  // [apple, cherry]
    ```
    
    iteratorã«ã¯removeãƒ¡ã‚½ãƒƒãƒ‰ãŒã‚ã‚‹ã®ã§ãã¡ã‚‰ã®å‡¦ç†ã‚’å®Ÿè£…ã™ã‚‹ã“ã¨ã§ãƒªã‚¹ãƒˆã‹ã‚‰ "banana" ã‚’å®‰å…¨ã«å‰Šé™¤ã—ã¦ã„ã¾ã™ã€‚
    ã“ã®ã‚ˆã†ãªæ“ä½œã‚’for-eachãƒ«ãƒ¼ãƒ—ã§è¡Œã†ã¨ ConcurrentModificationException ãŒç™ºç”Ÿã—ã¾ã™ã€‚
    
3. **ç‹¬è‡ªã®ãƒ‡ãƒ¼ã‚¿æ§‹é€ **: ã‚«ã‚¹ã‚¿ãƒ ã®ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã‚„å¤–éƒ¨ã®ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ã«å¯¾ã™ã‚‹åå¾©å‡¦ç†ã‚’å®Ÿè£…ã™ã‚‹å ´åˆã€**`Iterator`** ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ä½¿ç”¨ã—ã¦ã€ãã®ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã‚„ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ã‚’Javaã®for-eachãƒ«ãƒ¼ãƒ—ã§ä½¿ç”¨ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
4. **é…å»¶è©•ä¾¡**: ä¸€éƒ¨ã® **`Iterator`** ã®å®Ÿè£…ã¯ã€æ¬¡ã®è¦ç´ ãŒå¿…è¦ã«ãªã‚‹ã¾ã§ãƒ‡ãƒ¼ã‚¿ã®å–å¾—ã‚„è¨ˆç®—ã‚’é…å»¶ã•ã›ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€å·¨å¤§ãªãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚„ç„¡é™ã®ãƒ‡ãƒ¼ã‚¿ã‚¹ãƒˆãƒªãƒ¼ãƒ ã‚’åŠ¹ç‡çš„ã«å‡¦ç†ã™ã‚‹ã“ã¨ãŒå¯èƒ½ã«ãªã‚Šã¾ã™ã€‚
è‡ªç„¶æ•°ã®ã‚¹ãƒˆãƒªãƒ¼ãƒ ã®ä¾‹ã‚’ä»¥ä¸‹ã«ç¤ºã—ã¾ã™ã€‚
    
    ```java:java
    public class NaturalNumbers implements Iterable<Long> {
        @Override
        public Iterator<Long> iterator() {
            return new Iterator<Long>() {
                private long current = 1;
    
                @Override
                public boolean hasNext() {
                    return true;  // è‡ªç„¶æ•°ã¯ç„¡é™
                }
    
                @Override
                public Long next() {
                    return current++;
                }
            };
        }
    }
    
    // ã“ã®ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚¿ã‚’ä½¿ç”¨ã—ã¦æœ€åˆã®5ã¤ã®è‡ªç„¶æ•°ã‚’å‡ºåŠ›ã™ã‚‹
    Iterator<Long> numbers = new NaturalNumbers().iterator();
    for (int i = 0; i < 5; i++) {
        System.out.println(numbers.next());  // 1, 2, 3, 4, 5 ãŒé †ã«å‡ºåŠ›ã•ã‚Œã‚‹
    }
    ```
    
    ã“ã†ã™ã‚‹ã“ã¨ã§ã€è‡ªç„¶æ•°ã‚’ã©ã‚Œã ã‘è¡¨ç¤ºã™ã‚‹ã‹ã¨ã„ã†è¨ˆç®—ã‚’é…å»¶ã•ã›ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
    å‹ã¨å‡¦ç†ã‚’åˆ†é›¢ã™ã‚‹ã“ã¨ã§å†åˆ©ç”¨æ€§ã€ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°ãŒç°¡å˜ã«ãªã‚Šã¾ã™ã€‚
    

æŠ½è±¡åŒ–ã¯å†—é•·ã«è¦‹ãˆã¾ã™ãŒã€ã‚ˆã‚ŠæŸ”è»Ÿãªã‚³ãƒ¼ãƒ‰ã«ãªã‚‹ã®ã§å¿…è¦ãªã‚¿ã‚¤ãƒŸãƒ³ã‚°ã‚’è¦‹æ¥µã‚ã¦ä½¿ãˆã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ã‚‡ã†ï¼ï¼ˆåƒ•ã‚‚ã¾ã ä½¿ã„ã“ãªã›ã¾ã›ã‚“ãŒï¼‰

See you laterğŸ‘‹