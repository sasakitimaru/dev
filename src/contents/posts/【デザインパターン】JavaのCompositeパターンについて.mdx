---
title: ã€ãƒ‡ã‚¶ã‚¤ãƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³ã€‘Javaã®Compositeãƒ‘ã‚¿ãƒ¼ãƒ³ã«ã¤ã„ã¦
slug: design-pattern/java-composite-pattern
icon: â˜•ï¸
description: ä»Šå›ã¯Compositeãƒ‘ã‚¿ãƒ¼ãƒ³ã«ã¤ã„ã¦è§£èª¬ã—ã¾ã™ã€‚
date: "2023-09-24"
tags:
    - Java
    - ãƒ‡ã‚¶ã‚¤ãƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³
categories:
    - ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°
---

## Composite

éšå±¤æ§‹é€ ã‚’ä½œã‚‹éš›ã«ç”¨ã„ã‚‹ãƒ‡ã‚¶ã‚¤ãƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³ã§ã™ã€‚
ä¾‹ãˆã°ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ ãªã©ã‚’è¡¨ç¾ã™ã‚‹æ™‚ã€ãƒ•ã‚©ãƒ«ãƒ€ã¨ãƒ•ã‚¡ã‚¤ãƒ«ã«åˆ†ã‹ã‚ŒãŸã‚¯ãƒ©ã‚¹ã‚’æƒ³åƒã™ã‚‹ã¨æ€ã„ã¾ã™ã€‚
ã“ã®å€ã€ãƒ•ã‚©ãƒ«ãƒ€ã®ä¸­ã«ã¯ãƒ•ã‚©ãƒ«ãƒ€ã‚‚ãƒ•ã‚¡ã‚¤ãƒ«ã‚‚å­˜åœ¨ã™ã‚‹ã“ã¨ãŒæƒ³å®šã•ã‚Œã¾ã™ã€‚
ãƒ•ã‚©ãƒ«ãƒ€ã®ä¸­ã«ãƒ•ã‚©ãƒ«ãƒ€ãŒã‚ã‚‹ã¨ã€ãã®ä¸­ã«ã¾ãŸãƒ•ã‚©ãƒ«ãƒ€ã¨ãƒ•ã‚¡ã‚¤ãƒ«ãŒâ€¦ã¨å†èµ·çš„ã«ç¶šã„ã¦ã„ãã¯ãšã§ã™ã€‚
Compositeãƒ‘ã‚¿ãƒ¼ãƒ³ã§ã¯ã€ãƒ•ã‚¡ã‚¤ãƒ«ã¨ãƒ•ã‚©ãƒ«ãƒ€ã‚’åŒä¸€è¦–ã—ãŸã€Œ**å®¹å™¨**ã€ã®ã‚ˆã†ãªã‚‚ã®ã‚’å®šç¾©ã™ã‚‹ã“ã¨ã«ãªã‚Šã¾ã™ã€‚
ã“ã®å®¹å™¨ã‚’ç”¨ã„ã‚‹ã“ã¨ã§å†èµ·çš„ã«è¡¨ç¾ãŒã—ã‚„ã™ããªã‚Šã¾ã™ã€‚

## å®Ÿè£…

ä»Šå›ã¯ã‚³ãƒ¡ãƒ³ãƒˆã¨ãƒªãƒ—ãƒ©ã‚¤ã‚’ä½œã£ã¦ã„ãã¾ã™ã€‚
ãœã²å…ˆã»ã©ç´¹ä»‹ã—ãŸãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ ã«ç…§ã‚‰ã—åˆã‚ã›ã¦ã”è‡ªèº«ã§ã©ã®ã‚ˆã†ãªæ§‹é€ ã«ãªã‚‹ã‹æƒ³åƒã—ã¦ã¿ã¦ãã ã•ã„ã€‚

### Conversation

å…ˆã»ã©ç¤ºã—ãŸ`å®¹å™¨`ã«å½“ãŸã‚‹éƒ¨åˆ†ã«ãªã‚Šã¾ã™ã€‚
ã“ã®å®¹å™¨ãŒã‚ã‚‹ã“ã¨ã§ã€å¾Œã»ã©å†èµ·çš„ã«ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å‚ç…§ã™ã‚‹éš›ã«ãã‚ŒãŒ**ã‚³ãƒ¡ãƒ³ãƒˆ**ãªã®ã‹**ãƒªãƒ—ãƒ©ã‚¤**ãªã®ã‹ã‚’æ„è­˜ã™ã‚‹å¿…è¦ãŒç„¡ããªã‚Šã¾ã™ã€‚
ã“ã“ã§ã¯ã‚³ãƒ¡ãƒ³ãƒˆã‚‚ã—ãã¯ãƒªãƒ—ãƒ©ã‚¤ãŒã¤ã„ã¦ã„ã‚‹éš›ã«ã©ã®ã‚¹ãƒ¬ãƒƒãƒ‰ã§è¿”ä¿¡ã—ã¦ã„ã‚‹ã®ã‹ã‚’ç¤ºã™ãŸã‚ã«æ·±ã•ï¼ˆã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆï¼‰ã‚’å®šç¾©ã—ã¦ã„ã¾ã™ã€‚
ã¾ãŸã€ã‚³ãƒ¡ãƒ³ãƒˆã‚’å–å¾—ã™ã‚‹ãŸã‚ã®æŠ½è±¡ãƒ¡ã‚½ãƒƒãƒ‰ã‚‚å®šç¾©ã—ã¦ãŠãã¾ã™ã€‚

```java:java
import java.util.Arrays;

public abstract class Conversation {
    protected int depth = 0;
    protected String getIndent() {
        char[] chars = new char[depth * 4];
        Arrays.fill(chars, ' ');
        return new String(chars);
    }
    public abstract void getComment();
}
```

### Comment

Conversationã®ã‚µãƒ–ã‚¯ãƒ©ã‚¹ã«ãªã‚Šã¾ã™ã€‚
ã‚³ãƒ¡ãƒ³ãƒˆã«ã¯ã‚³ãƒ¡ãƒ³ãƒˆorãƒªãƒ—ãƒ©ã‚¤ãŒä»˜éšã™ã‚‹ã‚¤ãƒ¡ãƒ¼ã‚¸ã§ã™ã€‚
ã“ã“ã§ã€ã‚³ãƒ¡ãƒ³ãƒˆã¯è¿”ä¿¡ã‚’å—ã‘ä»˜ã‘ã‚‹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã€ãƒªãƒ—ãƒ©ã‚¤ã¯ã“ã‚Œä»¥ä¸Šè¿”ä¿¡ã‚’å—ã‘ä»˜ã‘ãªã„ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¨ã—ã¾ã™ã€‚
ã‚³ãƒ¡ãƒ³ãƒˆã¯Conversationå‹ã®ãƒªã‚¹ãƒˆã‚’æŒã¡ã€ãã“ã«ä½•æŸã‹ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¿½åŠ ã•ã‚Œã¦ã„ãã¾ã™ã€‚
å…ˆã»ã©ç¤ºã—ãŸé€šã‚Šã€Conversationã¯å®¹å™¨ã¨ã—ã¦å®šç¾©ã•ã‚Œã¦ã„ã¾ã™ã€‚
ãã—ã¦ã‚³ãƒ¡ãƒ³ãƒˆã‚’å–å¾—ã™ã‚‹getCommentãƒ¡ã‚½ãƒƒãƒ‰ã§å†èµ·çš„ã«å®¹å™¨ã®ä¸­èº«ã‚’å–å¾—ã—ã¾ã™ã€‚
å®¹å™¨ã®ä¸­èº«ãŒãƒªãƒ—ãƒ©ã‚¤ãªã®ã‹ã€ã‚³ãƒ¡ãƒ³ãƒˆãªã®ã‹ã‚’æ„è­˜ã›ãšã¨ã‚‚ã“ã‚Œã§ã‚³ãƒ¡ãƒ³ãƒˆã®ä¸€è¦§ã‚’å–å¾—ã™ã‚‹ã“ã¨ã«æˆåŠŸã—ã¾ã—ãŸã€‚

```java:java
import java.util.ArrayList;
import java.util.Arrays;
import java.util.List;

public class Comment extends Conversation {
    private final String comment;
    private final List<Conversation> conversations = new ArrayList<>();
    public Comment(String comment) {
        this.comment = comment;
    }

    public void add(Conversation cv) {
        cv.depth = this.depth + 1;
        this.conversations.add(cv);
    }
    @Override
    public void getComment() {
        if (this.depth == 0) System.out.println(this.comment);
        else System.out.println(this.getIndent() + "|-" + this.comment);
        for (Conversation cv : this.conversations) {
            cv.getComment();
        }
    }
}
```

### Reply

Conversationã®ã‚µãƒ–ã‚¯ãƒ©ã‚¹ã«ãªã‚Šã¾ã™ã€‚
ã‚³ãƒ¡ãƒ³ãƒˆã‚¯ãƒ©ã‚¹ã‹ã‚‰Conversationã¨ã„ã†å®¹å™¨ã‚’æ¬¡ã€…ã¨å‚ç…§ã—ã¦ã„ãéš›ã«ã€ã“ã®Replyã®getCommentãƒ¡ã‚½ãƒƒãƒ‰ãŒå‚ç…§ã•ã‚Œã¾ã™ã€‚
å®¹å™¨ã§æŠ½è±¡åŒ–ã•ã‚Œã¦ã„ã‚‹ãŸã‚ãƒªãƒ—ãƒ©ã‚¤ãªã®ã‹ã‚³ãƒ¡ãƒ³ãƒˆãªã®ã‹ã‚’æ„è­˜ã™ã‚‹ã“ã¨ã¯ãªã„ã§ã™ã€‚

```java:java
public class Reply extends Conversation {
    private String comment;
    public Reply(String comment) {
        this.comment = comment;
    }
    @Override
    public void getComment() {
        System.out.println(this.getIndent() + "|-" + this.comment);
    }
}
```

## å®Ÿè¡Œ

### Main

ã‚³ãƒ¡ãƒ³ãƒˆã‚’ä½œæˆã—ã€ã‚³ãƒ¡ãƒ³ãƒˆã«å¯¾ã—ã¦ã‚³ãƒ¡ãƒ³ãƒˆã‚‚ã—ãã¯ãƒªãƒ—ãƒ©ã‚¤ã‚’è¿½åŠ ã—ã¦ã„ãã¾ã™ã€‚
æœ€å¾Œã«ã‚³ãƒ¡ãƒ³ãƒˆã®getCommentãƒ¡ã‚½ãƒƒãƒ‰ã‹ã‚‰ã‚³ãƒ¡ãƒ³ãƒˆãŒæŒã£ã¦ã„ã‚‹ã‚³ãƒ¡ãƒ³ãƒˆã€ãƒªãƒ—ãƒ©ã‚¤ã‚’å…¨ã¦è¡¨ç¤ºã—ã¾ã™ã€‚

```java:java
import java.util.ArrayList;
import java.util.List;

public class Main {
    public static void main(String[] args) {
        List<Comment> comments = new ArrayList<>();
        Comment c1 = new Comment("ã“ã‚“ã«ã¡ã¯");
        c1.add(new Reply("ã¯ã˜ã‚ã¾ã—ã¦"));
        c1.add(new Reply("ã“ã‚“ã«ã¡ã¯ï¼"));
        Comment c1_1 = new Comment("åå‰ã‚’æ•™ãˆã¦ãã ã•ã„");
        c1.add(c1_1);
        c1_1.add(new Reply("ç§ã¯æ —æ¾ã§ã™"));
        Comment c2 = new Comment("ã“ã‚“ã°ã‚“ã¯");
        c2.add(new Reply("ã“ã‚“ã°ã‚“ã¯ï¼"));
        c2.add(new Reply("ãŠã‚„ã™ã¿ãªã•ã„"));
        comments.add(c1);
        comments.add(c2);
        for (Comment c : comments) {
            c.getComment();
        }
    }
}
```

å®Ÿè¡Œçµæœ

```
ã“ã‚“ã«ã¡ã¯
    |-ã¯ã˜ã‚ã¾ã—ã¦
    |-ã“ã‚“ã«ã¡ã¯ï¼
    |-åå‰ã‚’æ•™ãˆã¦ãã ã•ã„
        |-ç§ã¯æ —æ¾ã§ã™
ã“ã‚“ã°ã‚“ã¯
    |-ã“ã‚“ã°ã‚“ã¯ï¼
    |-ãŠã‚„ã™ã¿ãªã•ã„
```

See you later ğŸ‘‹