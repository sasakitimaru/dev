---
title: ã€ãƒ‡ã‚¶ã‚¤ãƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³ã€‘Javaã®Chain of Responsibilityãƒ‘ã‚¿ãƒ¼ãƒ³ã«ã¤ã„ã¦
slug: design-pattern/java-chain-of-responsibility-pattern
icon: â˜•ï¸
description: ä»Šå›ã¯Chain of Responsibilityãƒ‘ã‚¿ãƒ¼ãƒ³ã«ã¤ã„ã¦è§£èª¬ã—ã¾ã™ã€‚
date: "2023-09-26"
tags:
    - Java
    - ãƒ‡ã‚¶ã‚¤ãƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³
categories:
    - ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°
---

## Chain of Responsibility

è²¬ä»»ã®ãŸã‚‰ã„å›ã—ã§ã™ã€‚
è·å ´ã§ã¨ã‚ã‚‹ã‚·ã‚¹ãƒ†ãƒ ã®ãƒ­ã‚°ãƒ‡ãƒ¼ã‚¿ãŒæ¬²ã—ã‹ã£ãŸã¨ã—ã¾ã—ã‚‡ã†ã€‚
ã¾ãšã‚·ã‚¹ãƒ†ãƒ é–‹ç™ºéƒ¨ã®Aã•ã‚“ã«èãã¾ã™ã€‚
ã™ã‚‹ã¨Aã•ã‚“ã¯ãƒ­ã‚°å–å¾—ã¯ã‚·ã‚¹ãƒ†ãƒ é‹ç”¨éƒ¨ã®æ‹…å½“ã¨è¨€ã„ã¾ã—ãŸã€‚
ä»•æ–¹ãŒãªã„ã®ã§é‹ç”¨éƒ¨ã®Bã•ã‚“ã«èã„ã¦ã¿ãŸã¨ã“ã‚ã€ãƒ­ã‚°å–å¾—ã¯ãƒ™ãƒ³ãƒ€ãƒ¼ã«ä¾é ¼ã—ã¦ãŠã‚Šæƒ…å ±ã‚·ã‚¹ãƒ†ãƒ éƒ¨ã§ãªã„ã¨é€£çµ¡å…ˆãŒã‚ã‹ã‚‰ãªã„ã¨è¨€ã„ã¾ã™ã€‚
ã“ã®ã‚ˆã†ã«æ¬¡ã€…ã¨ã‚¿ã‚¹ã‚¯ã‚’ãŸã‚‰ã„å›ã—ã«ã—ãªãŒã‚‰è§£æ±ºã¸è¿‘ã¥ããŸã‚ã®è¨­è¨ˆãŒChain of Responsibilityã§ã™ã€‚

## å®Ÿè£…

ä»Šå›ã¯å˜ç´”ã«ç™ºç”Ÿã—ãŸãƒˆãƒ©ãƒ–ãƒ«ã‚’ãƒŠãƒ³ãƒãƒ¼ã§ç®¡ç†ã—ã€ç•ªå·ã«å¿œã˜ãŸã‚µãƒãƒ¼ãƒˆå½¹ã«è¾¿ã‚Šç€ã‘ã‚Œã°è§£æ±ºã™ã‚‹ã¨ã„ã†ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’çµ„ã¿ã¾ã™ã€‚

### Trouble

ç™ºç”Ÿã—ãŸãƒˆãƒ©ãƒ–ãƒ«ã‚’è¡¨ç¾ã™ã‚‹ã‚¯ãƒ©ã‚¹ã§ã™ã€‚
ç•ªå·ã§ç®¡ç†ã—ã¾ã™ã€‚

```java:java
public class Trouble {
    private int number;

    public Trouble(int number) {
        this.number = number;
    }

    public int getNumber() {
        return number;
    }

    public String toString() {
        return "[Trouble " + number + "]";
    }
}
```

### Support

å•é¡Œè§£æ±ºã‚’ã—ã¦ãã‚Œã‚‹ã‚µãƒãƒ¼ãƒˆå½¹ã®äººã®æŠ½è±¡ã‚¯ãƒ©ã‚¹ã§ã™ã€‚
ã“ã“ã§ã¯å…±é€šã®ãƒ­ã‚¸ãƒƒã‚¯ã¨ã—ã¦ã€å•é¡ŒãŒè§£æ±ºã—ãªã‘ã‚Œã°ã‚»ãƒƒãƒˆã•ã‚Œã¦ã„ã‚‹æ¬¡ã®ã‚µãƒãƒ¼ãƒˆå½¹ã«å›ã™ã¨ã„ã†å‡¦ç†ã‚’å®Ÿè£…ã—ã¾ã™ã€‚
å…·ä½“çš„ãªå®Ÿè£…ã¯ãã‚Œãã‚Œã®ã‚µãƒãƒ¼ãƒˆå½¹ã®äººã«å¿œã˜ã¦å®Ÿè£…ã—ã¾ã™ã€‚

```java:java
public abstract class Support {
    private String name;
    private Support next;

    public Support(String name) {
        this.name = name;
    }

    public Support setNext(Support next) {
        this.next = next;
        return next;
    }

    public final void support(Trouble trouble) {
        if (resolve(trouble)) {
        done(trouble);
        } else if (next != null) {
        next.support(trouble);
        } else {
        fail(trouble);
        }
    }

    public String toString() {
        return "[" + name + "]";
    }

    protected abstract boolean resolve(Trouble trouble);

    protected void done(Trouble trouble) {
        System.out.println(trouble + " is resolved by " + this + ".");
    }

    protected void fail(Trouble trouble) {
        System.out.println(trouble + " cannot be resolved.");
    }
}
```

### NoSupport

å•é¡Œè§£æ±ºã‚’ã—ãªã„ã‚¯ãƒ©ã‚¹ã§ã™ã€‚
~~ä½•ã‚‚ã—ãªã„äººã¯ã©ã“ã«ã§ã‚‚ã„ã‚‹~~

```java:java
public class NoSupport extends Support {
    public NoSupport(String name) {
        super(name);
    }
    @Override
    protected boolean resolve(Trouble trouble) {
        return false;
    }
}
```

### LimitSupport

è¨­å®šã•ã‚ŒãŸãƒŠãƒ³ãƒãƒ¼ä»¥ä¸‹ã®ãƒˆãƒ©ãƒ–ãƒ«ã§ã‚ã‚Œã°è§£æ±ºã™ã‚‹ã“ã¨ãŒã§ãã‚‹ã‚¯ãƒ©ã‚¹ã§ã™ã€‚

```java:java
public class LimitSupport extends Support {
    private int limit;

    public LimitSupport(String name, int limit) {
        super(name);
        this.limit = limit;
    }

    @Override
    protected boolean resolve(Trouble trouble) {
        if (trouble.getNumber() < limit) {
        return true;
        } else {
        return false;
        }
    }
}
```

### OddSupport

å¥‡æ•°ã®ãƒŠãƒ³ãƒãƒ¼ã®ãƒˆãƒ©ãƒ–ãƒ«ãªã‚‰è§£æ±ºã™ã‚‹ã“ã¨ãŒã§ãã‚‹ã‚¯ãƒ©ã‚¹ã§ã™ã€‚

```java:java
public class OddSupport extends Support {
    public OddSupport(String name) {
        super(name);
    }
    @Override
    protected boolean resolve(Trouble trouble) {
        return trouble.getNumber() % 2 == 1;
    }
}
```

## å®Ÿè¡Œ

### Main

ã©ã®é †ç•ªã§ãŸã‚‰ã„å›ã—ã¦ã„ãã‹ã¯setNextã§è¨­å®šã—ã¾ã™ã€‚
ã‚ã¨ã¯å›ã™ã ã‘ã§ã™ã€‚

```java:java
public class Main {
    public static void main(String[] args) {
        Support alice = new NoSupport("Alice");
        Support bob = new LimitSupport("Bob", 100);
        Support diana = new LimitSupport("Diana", 200);
        Support elmo = new OddSupport("Elmo");
        Support fred = new LimitSupport("Fred", 300);

        // Set up the chain of responsibility
        alice.setNext(bob).setNext(diana).setNext(elmo).setNext(fred);

        // Make various requests
        for (int i = 0; i < 500; i += 33) {
            alice.support(new Trouble(i));
        }
    }
}
```

å®Ÿè¡Œçµæœ

```
[Trouble 0] is resolved by [Bob].
[Trouble 33] is resolved by [Bob].
[Trouble 66] is resolved by [Bob].
[Trouble 99] is resolved by [Bob].
[Trouble 132] is resolved by [Diana].
[Trouble 165] is resolved by [Diana].
[Trouble 198] is resolved by [Diana].
[Trouble 231] is resolved by [Elmo].
[Trouble 264] is resolved by [Fred].
[Trouble 297] is resolved by [Elmo].
[Trouble 330] cannot be resolved.
[Trouble 363] is resolved by [Elmo].
[Trouble 396] cannot be resolved.
[Trouble 429] is resolved by [Elmo].
[Trouble 462] cannot be resolved.
[Trouble 495] is resolved by [Elmo].
```

## ãªã‚“ã§å¿…è¦ãªã®ï¼Ÿ

ã‚µãƒãƒ¼ãƒˆå½¹ã‚’ãŸãã•ã‚“ç«‹ã¦ã¦ãŸã‚‰ã„å›ã—ã«ã™ã‚‹ã‚ˆã‚Šã€ã©ã“ã‹ã«ã‚¿ã‚¹ã‚¯ã‚’æŒ¯ã‚Šåˆ†ã‘ã‚‹æ©Ÿèƒ½ã‚’é›†ä¸­ã•ã›ã¦æ¡ä»¶åˆ†å²ã•ã›ãŸæ–¹ãŒå‡¦ç†ã‚‚æ—©ãã‚ã‹ã‚Šã‚„ã™ã„ã‚ˆã†ã«ã‚‚æ„Ÿã˜ã¾ã™ã€‚ï¼ˆå®Ÿéš›ãã†ã§ã‚ã‚‹ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚‚ã‚ã‚‹ï¼‰
ã—ã‹ã—ä¸Šè¨˜ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã§è€ƒãˆã‚‹ã¨ã‚¿ã‚¹ã‚¯ã‚’ãŸã‚‰ã„å›ã—ã§ã¯ãªãã€é©åˆ‡ã«æŒ¯ã‚Šåˆ†ã‘ã‚‹å ´åˆã¯ãã®æŒ¯ã‚Šåˆ†ã‘å½¹ãŒå…¨ã¦ã®ã‚µãƒãƒ¼ãƒˆå½¹ã®æŒ™å‹•ã‚’çŸ¥ã£ã¦ã„ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
ãã†ãªã‚‹ã¨ã‚¯ãƒ©ã‚¹é–“ã§ã®çµã³ã¤ãã¯ã‚ˆã‚Šå¼·ããªã‚Šã¾ã™ã€‚
ã¾ãŸã€ãã®åˆ¤æ–­å½¹ã¯èª°ã«ãªã‚‹ã®ã‹ã¨ã„ã†è©±ã‚‚å‡ºã¦ãã¾ã™ã€‚
ã‚µãƒãƒ¼ãƒˆå½¹ã¯è‡ªåˆ†ã®å‡¦ç†ã ã‘ã‚’å®Ÿè£…ã™ã‚‹ã“ã¨ã«æ„å‘³ãŒã‚ã‚‹ä»¥ä¸Šã€åˆ¤æ–­å½¹ã¯ã€Œè¦æ±‚ã‚’å‡ºã™äººã€ã«é›†ã‚ã‚‹ã—ã‹ãªã„ã§ã™ã€‚
ãã†ãªã‚‹ã¨è¦æ±‚ã‚’å‡ºã™äººãŒå…¨ã¦ã®ã‚µãƒãƒ¼ãƒˆå½¹ã®å‡¦ç†ã‚’æŠŠæ¡ã™ã‚‹å¿…è¦ãŒå‡ºã¦ãã¾ã™ã€‚
ã“ã†ãªã‚‹ã¨æœ¬æœ«è»¢å€’ã§ã™ã€‚
å˜ç´”ãªãŸã‚‰ã„å›ã—ã®æ§‹é€ ã«ã™ã‚‹ã“ã¨ã§è¦æ±‚ã‚’å‡ºã™äººã¨è¦æ±‚ã‚’å‡¦ç†ã™ã‚‹äººã‚’ã‚†ã‚‹ã‚„ã‹ã«çµã³ã¤ã‘ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
ã“ã‚Œã«ã‚ˆã£ã¦ã€å‡¦ç†ãŒå‹•çš„ã«å¢—ãˆã¦ã‚‚è¤‡é›‘ãªãƒ­ã‚¸ãƒƒã‚¯ã‚‚ãªã—ã«ã‚µãƒãƒ¼ãƒˆå½¹ã‚’è¿½åŠ ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
ãŸã ã€ãŸã‚‰ã„å›ã—ãªã®ã§æœ€é©ãªåˆ¤æ–­ã¯ä¸‹ã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚
ãã®åˆ†å‡¦ç†ã¯é…ããªã£ã¦ã„ã¾ã™ã€‚
ã“ã“ã‚‰è¾ºã¯ãƒˆãƒ¬ãƒ¼ãƒ‰ã‚ªãƒ•ã®å•é¡Œã«ãªã£ã¦ã„ã¾ã™ã€‚
ä¸Šè¨˜ã§æç¤ºã—ãŸãƒ¡ãƒªãƒƒãƒˆã¨å‡¦ç†é€Ÿåº¦ã‚’å¤©ç§¤ã«ã‹ã‘ã¦ã“ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’é©ç”¨ã™ã‚‹ã‹è€ƒãˆã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

See you later ğŸ‘‹