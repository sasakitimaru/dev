---
title: ã€ãƒ‡ã‚¶ã‚¤ãƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³ã€‘Javaã®Singletonãƒ‘ã‚¿ãƒ¼ãƒ³ã«ã¤ã„ã¦
slug: design-pattern/java-singleton-pattern
icon: â˜•ï¸
description: ä»Šå›ã¯Singletonãƒ‘ã‚¿ãƒ¼ãƒ³ã«ã¤ã„ã¦è§£èª¬ã—ã¾ã™ã€‚
date: "2023-09-16"
tags:
  - Java
  - ãƒ‡ã‚¶ã‚¤ãƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³
categories:
  - ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°
---
## Singleton

ã€ŒSingletonãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’æ¡ç”¨ã—ãŸã‚¯ãƒ©ã‚¹ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã¯å¿…ãš1ã¤ã—ã‹å­˜åœ¨ã—ãªã„ã€ã¨è¨€ã†ã“ã¨ã‚’ç´„æŸã™ã‚‹ã‚‚ã®ã§ã™ã€‚
æ™®é€šã®ã‚¯ãƒ©ã‚¹ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã¯è¤‡æ•°ä½œæˆã—ã¦å‡¦ç†ã‚’åˆ¥ã€…ã§è¡Œãªã£ã¦ã„ã¾ã™ãŒã€ãã‚Œã ã¨å›°ã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚ã‚·ã‚¹ãƒ†ãƒ å…¨ä½“ã®è¨­å®šã‚’ç®¡ç†ã™ã‚‹ã‚¯ãƒ©ã‚¹ã‚„ã€ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰ãªã©ã®è¨­å®šã‚’ç®¡ç†ã™ã‚‹ã‚¯ãƒ©ã‚¹ãŒè¤‡æ•°ã‚ã‚‹ã¨å‚ç…§ã™ã‚‹ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã«ã‚ˆã£ã¦å€¤ãŒå¤‰ã‚ã£ã¦ã—ã¾ã„ä¸€è²«æ€§ãŒãªããªã£ã¦ã—ã¾ã„ã¾ã™ã€‚
ï¼ˆã“ã£ã¡ã®ãƒšãƒ¼ã‚¸ã§ã¯ãƒ©ã‚¤ãƒˆãƒ¢ãƒ¼ãƒ‰ãªã®ã«ã“ã£ã¡ã ã¨ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰ã«ãªã£ã¦ã‚‹ã¿ãŸã„ãªï¼‰
ä»Šå›ã¯è²¯é‡‘ç®±ã‚’ç”¨ã„ã¦ã‚¹ãƒ¬ãƒƒãƒ‰ã‚»ãƒ¼ãƒ•ãªSingletonãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’å®Ÿè£…ã—ã¦ã„ãã¾ã™ã€‚
â€»ã‚¹ãƒ¬ãƒƒãƒ‰ã‚»ãƒ¼ãƒ•ï¼šåŒæ™‚ã«ã‚¢ã‚¯ã‚»ã‚¹ã•ã‚Œã¦ã‚‚æ­£ã—ã„çµæœã‚’è¿”ã™ã“ã¨ãŒã§ãã‚‹ã€‚å£åº§10ä¸‡å††èª°ã‹ãŒè²¯é‡‘ã—ãŸã®ã«è²¯é‡‘ã™ã‚‹å‰ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ãŸã‹ã‚‰æ®‹é«˜å¢—ãˆã¦ãªã„ã€ã¿ãŸã„ãªçŠ¶æ³ã‚’é˜²ãã€‚
ã˜

## å®Ÿè£…

### Savingã‚¯ãƒ©ã‚¹

Savingã‚¯ãƒ©ã‚¹ã«Singletonãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’æ¡ç”¨ã—ã¦ã„ãã¾ã™ã€‚
Savingã‚¯ãƒ©ã‚¹ã®ä¸­ã§staticãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã¨ã—ã¦Saving svãŒå®šç¾©ã•ã‚Œã¾ã™ã€‚
ã“ã‚Œã«ã‚ˆã‚Šã‚¯ãƒ©ã‚¹å¤‰æ•°ã¨ã—ã¦svã‚’æŒã¤ã“ã¨ãŒã§ãã€æœ€åˆã«Savingã‚’å‚ç…§ã—ãŸæ™‚ï¼ˆãƒ­ãƒ¼ãƒ‰ã—ãŸæ™‚ï¼‰ã®ã¿svã¯åˆæœŸåŒ–ã•ã‚Œã¾ã™ã€‚
ã¾ãŸã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã«privateä¿®é£¾å­ã‚’ä»˜ã‘ã‚‹ã“ã¨ã«ã‚ˆã£ã¦å‹æ‰‹ã«ã‚¯ãƒ©ã‚¹å¤–éƒ¨ã‹ã‚‰ç›´æ¥ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã‚’å‚ç…§ã—ã¦åˆæœŸåŒ–ã•ã‚Œã‚‹ã“ã¨ã‚’é˜²ã„ã§ã„ã¾ã™ã€‚

```java:java
package singleton;

public class Saving {
    private int money = 0;
		// staticãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã§å®šç¾©ã™ã‚‹ã“ã¨ã§ä¸€åº¦ã—ã‹åˆæœŸåŒ–ã•ã‚Œãšä¸€è²«æ€§ã‚’ä¿ã¤
    private static final Saving sv = new Saving();
		// privateä¿®é£¾å­ã«ã‚ˆã£ã¦Savingã‚¯ãƒ©ã‚¹å¤–ã‹ã‚‰ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã®å‘¼ã³å‡ºã—ã‚’ç¦æ­¢
    private Saving() {}
    public static Saving getInstance() {
        return sv;
    }
    public synchronized void addMoney(int money) {
        this.money += money;
        System.out.println("Add: " + money);
        System.out.println("Total: " + this.money);
    }
    public synchronized void subtractMoney(int money) {
        this.money -= money;
        System.out.println("Subtract: " + money);
        System.out.println("Total: " + this.money);
    }
    public synchronized int getMoney() {
        return money;
    }
}
```

Savingã‚¯ãƒ©ã‚¹ã§ã¯ãŠé‡‘ã®è²¯é‡‘ï¼ˆaddMoneyï¼‰ã¨å¼•ãè½ã¨ã—ï¼ˆsubtractMoneyï¼‰ã‚’å®Ÿè£…ã—ã¦ã„ã¾ã™ã€‚

### Mainã‚¯ãƒ©ã‚¹

å®Ÿéš›ã«Mainã‚¯ãƒ©ã‚¹ã§2ã¤åŒæ™‚ã«å‡¦ç†ã‚’èµ°ã‚‰ã›ã¦ã¿ã¾ã—ã‚‡ã†ã€‚

```java:java
package singleton;

public class Main extends Thread {

    public static void main(String[] args) {
        Main threadA = new Main("TEST A");
        Main threadB = new Main("TEST B");
				// ãã‚Œãã‚Œã®å‡¦ç†å®Ÿè¡Œ
        threadA.start();
        threadB.start();
        try {
						// å‡¦ç†ã‚’å¾…ã¤
            threadA.join();
            threadB.join();
        } catch (InterruptedException e) {
            e.printStackTrace();
        }
				// çµæœã®å‡ºåŠ›
        System.out.println("Consequence: " + Saving.getInstance().getMoney());
    }

    @Override
    public void run() {
        Saving sv = Saving.getInstance();
        sv.addMoney(10000);
        sv.subtractMoney(5000);
        System.out.println(Thread.currentThread().getName() + " - Money: " + sv.getMoney());
    }

    public Main(String name) {
        super(name);
    }
}
```

å®Ÿè¡Œçµæœâ‘ 

```
Add: 10000
Total: 10000
Add: 10000
Total: 20000
Subtract: 5000
Total: 15000
Subtract: 5000
Total: 10000
TEST A - Money: 10000
TEST B - Money: 10000
Consequence: 10000
```

å®Ÿè¡Œçµæœâ‘¡

```
Add: 10000
Total: 10000
Add: 10000
Total: 20000
Subtract: 5000
Total: 15000
Subtract: 5000
Total: 10000
TEST A - Money: 10000
TEST B - Money: 15000
Consequence: 10000
```

çµæœã‹ã‚‰ã‚ã‹ã‚‹é€šã‚Šã€éç¨‹ã¯é•ãˆã©æœ€çµ‚çš„ãªé‡‘é¡ã¯åŒã˜ã«ãªã‚Šã¾ã™ã€‚
ã“ã‚Œã¯ä¸€ã¤ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’å…±æœ‰ã—ã€ãã“ã§ã‚¹ãƒ¬ãƒƒãƒ‰ã‚»ãƒ¼ãƒ•ãªå‡¦ç†ã‚’è¡Œãªã£ã¦ã„ã‚‹ãŸã‚ã§ã™ã€‚
åŒã˜è²¯é‡‘ç®±ã«å¯¾ã—ã¦ã€ã¿ã‚“ãªãŒé †ç•ªã«ä¸¦ã‚“ã§è²¯é‡‘ãƒ»å¼•ãè½ã¨ã—ã‚’ã—ã¦ã„ã‚‹ã‚¤ãƒ¡ãƒ¼ã‚¸ã§ã™ã€‚

See you laterğŸ‘‹